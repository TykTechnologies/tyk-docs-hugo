name: Link Checker
on:
  pull_request:

jobs:
  link-checker:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
        with:
          submodules: true  # Fetch Hugo themes (true OR recursive)
      - name: Check broken links
        run: |
          base_branch=$(jq -r ".pull_request.base.ref" "$GITHUB_EVENT_PATH")
          commit_before_pull_request=$(git merge-base $base_branch HEAD)
          
          cd tyk-docs && bash ../scripts/urlcheck.sh $commit_before_pull_request
