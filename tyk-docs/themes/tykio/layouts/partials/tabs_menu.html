{{- $pagePath := replace .Page.RelPermalink "/docs" "" -}}
{{- $pagePath := replace $pagePath "/nightly" "" -}}
{{- $pagePath := replace $pagePath "/" "" -}}
{{- $showEmptyPages := .Site.Params.showEmptyPages -}}

<div class="tabs-wrapper">
  <div class="tabs-container">
    {{- range .Site.Data.menu.menu -}}
      {{- if .tab_on_top -}}
        {{- $selected := false -}}
        {{- $is_home := eq (lower .title) "home" -}}
        {{- $path_not_empty := false -}}
        {{- $path := replace .path "/" "" -}}
        {{- $has_active_child := false -}}
        
        {{- if eq $path $pagePath -}}
          {{- $selected = true -}}
          {{- if or (ne $path "") $is_home -}}
            {{- $path_not_empty = true -}}
          {{- end -}}
        {{- end -}}

        {{- if (isset . "menu") -}}
          {{- range .menu -}}
            {{- $path := replace .path "/" "" -}}
            {{- if eq $path $pagePath -}}
              {{- $selected = true -}}
              {{- $has_active_child = true -}}
              {{- if or (ne $path "") $is_home -}}
                {{- $path_not_empty = true -}}
              {{- end -}}
            {{- end -}}
          {{- end -}}
        {{- end -}}

        {{- if or (.show) ($showEmptyPages) -}}
          <div class="tab-item {{if (and $selected $path_not_empty )}}nav_sub_active{{end}}">
            {{- if .url -}}
              <a href="{{ .url }}" class="tab-link {{if not .show}} paint-red {{end}} {{if (and $selected $path_not_empty )}} active{{end}}">{{- .title -}}</a>
            {{- else -}}
              {{- $prefixPath := strings.TrimLeft "/" .path -}}
              <a href="{{$prefixPath | relURL}}" class="tab-link {{if not .show}} paint-red {{end}} {{if (and $selected $path_not_empty )}} active{{end}}">{{- .title -}}</a>
            {{- end -}}
          </div>
        {{- end -}}
      {{- end -}}
    {{- end -}}
  </div>
</div>


