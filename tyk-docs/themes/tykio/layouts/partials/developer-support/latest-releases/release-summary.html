{{- $section := .section -}}
{{- $components := .components -}}

{{- with $section -}}
    <h3>{{- . -}}</h3>

    {{- with $components -}}

    <div class="container mt-4">
        <div class="row justify-content-center">
        {{ range $index, $component := $components }}
        <div class="col-md-4 mb-4">
            <!-- header -->
            <div class="card h-100">
            <div class="card-header bg-dark text-white">
                {{- $component.name -}}
            </div>

            <!-- body -->
            <div class="card-body">
                {{/* Determine license type */}}
                {{- $license := "Licensed" -}}
                {{- $licensed := .data.licensed -}}
                {{- $releaseNotesPath := .data.releaseNotesPath -}}
                {{- if not $licensed -}}
                    {{- $license = "Open Source" -}}
                {{ end }}
                
                {{/* Get latest and lts data */}}
                {{- $lts := false -}}
                {{- $ltsData := "" -}}
                {{- with .data.lts -}}
                    {{- $ltsData = index $component.data $component.data.lts -}}
                    {{- if $ltsData -}}
                        {{- $lts = true -}}
                    {{ end }}
                {{ end }}
                {{- $latest := false -}}
                {{- $latestData := "" -}}
                {{- with .data.latest -}}
                    {{- $latestData = index $component.data $component.data.latest -}}
                    {{- if $latestData -}}
                        {{- $latest = true -}}
                    {{ end }}
                {{ end }}
    
                <h6 class="card-title">
                    {{- with $component.data.latest -}}
                        {{- $title := $component.data.latest -}}
                        {{- if $component.data.lts -}}
                            {{- $title = printf "%s | %s (LTS)" $title $component.data.lts -}}
                        {{- end -}}
                        {{- $title -}}
                    {{ end }}
                </h6>
                <div class="mt-5">
                    <a href="{{ $releaseNotesPath | relURL }}" class="home_btn sec-btn">Release Notes</a>
                </div>
            </div>
    
            <!-- Footer -->
            <div
                class="card-footer text-muted d-flex justify-content-between align-items-center"
                style="font-size: 12px"
            >
                <!-- GitHub Images (Left Corner) -->
                <div class="d-flex align-items-start">
                {{- if and $latest (not $licensed) -}}
                <div class="d-flex flex-column align-items-center ml-3">
                    <a
                    href="{{- $latestData.tag -}}"
                    target="_blank"
                    rel="noopener noreferrer"
                    class="d-flex flex-column align-items-center"
                    >
                    <img src="{{ "img/github.svg" | relURL }}" alt="Latest GHub
                    Icon" class="icon" style="width: 32px; height: 32px" />
                    <span>{{- $component.data.latest -}}</span>
                    </a>
                </div>
                {{ end }}
                {{- if and $lts (not $licensed) -}}
                <div class="d-flex flex-column align-items-center ml-3">
                    <a
                    href="{{- $ltsData.tag -}}"
                    target="_blank"
                    rel="noopener noreferrer"
                    class="d-flex flex-column align-items-center"
                    >
                    <img src="{{ "img/github.svg" | relURL }}" alt="LTS GHub icon"
                    class="icon" style="width: 32px; height: 32px" />
                    <span>{{- $component.data.lts -}}</span>
                    </a>
                </div>
                {{ end }}
                </div>
    
                <!-- Docker Images (Right Corner) -->
                <div class="d-flex align-items-start">
                {{- if $latest -}}
                <div class="d-flex flex-column align-items-center ml-3">
                    <a
                    href="{{- $latestData.docker -}}"
                    target="_blank"
                    rel="noopener noreferrer"
                    class="d-flex flex-column align-items-center"
                    >
                    <img src="{{ "img/docker.png" | relURL }}" alt="Docker Latest
                    Icon" class="icon" style="width: 32px; height: 32px" />
                    <span>{{- $component.data.latest -}}</span>
                    </a>
                </div>
                {{ end }}
                {{- if $lts -}}
                <div class="d-flex flex-column align-items-center ml-3">
                    <a
                    href="{{- $latestData.docker -}}"
                    target="_blank"
                    rel="noopener noreferrer"
                    class="d-flex flex-column align-items-center"
                    >
                    <img src="{{ "img/docker.png" | relURL }}" alt="Docker LTS Icon"
                    class="icon" style="width: 32px; height: 32px" />
                    <span>{{- $component.data.lts -}}</span>
                    </a>
                </div>
                {{ end }}
                </div>
            </div>
            </div>
        </div>
        {{ end }}
        </div>
    </div>
    {{ end }}
{{ end }}